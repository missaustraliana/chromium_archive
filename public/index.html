<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="css/style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromium Archive</title>
    <style>

    </style>
</head>

<body>

    <div class="overlay">
        <h1 id="name">Downloading index.</h1>
        <div class="indeterminate-progress-bar">
            <div class="indeterminate-progress-bar__progress" id="progress"></div>
        </div>

    </div>
    <script>
        function bytesToMB(bytes) {
            return (bytes / (1024 * 1024)).toFixed(2);
        }
        fetch("index", {

            headers: {
                "Content-Type": "application/x-www-form-urlencoded"
            },
            method: "GET"
        }).then(response => {
            response.json().then(data => {
                for (let i = 0; i < data.availableBuildIndex.length; i++) {
                    
                    var chromiumversion = document.createElement('a');
                    var br = document.createElement('br');
                    chromiumversion.innerHTML = data.availableBuildIndex[i].chromium_version + " <span class=\"thin\">(" + data.availableBuildIndex[i].available_build_count + " builds)</span>"
                    
                    document.body.appendChild(chromiumversion);
                    document.body.appendChild(br);
                }
                
                var chromiumversion = document.createElement('a');
                    var br = document.createElement('br');
                    chromiumversion.innerHTML = "<span class=\"thin\">Showing " + data.availableBuilds + " builds</span>"
                    
                    document.body.appendChild(chromiumversion);
                document.body.appendChild(br);
               console.log(data.availableBuildIndex[1].chromium_version)
                document.getElementById("name").innerHTML = "Version Listing"
                document.getElementById("progress").hidden = true

            }
            ).catch((error) => {
                console.error(error)
                document.getElementById("progress").hidden = true
                document.getElementById("name").innerHTML = "Something went wrong."
            }
            )
        }
        )
    </script>
</body>

</html>